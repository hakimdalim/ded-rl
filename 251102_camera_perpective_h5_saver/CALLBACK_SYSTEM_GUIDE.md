# ğŸ“‹ CALLBACK SYSTEM COMPLETE GUIDE

## Overview

Your DED (Directed Energy Deposition) simulation uses an **event-driven callback architecture**
with **19 callback types** organized into 7 categories.

---

## 1ï¸âƒ£ SIMULATION EVENT FLOW

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     SIMULATION LIFECYCLE                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ CONFIG_LOADED    â”‚  â† Configuration file loaded
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚      INIT        â”‚  â† Simulation object created
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                    BUILD PROCESS                        â”‚
    â”‚                                                          â”‚
    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                    â”‚
    â”‚   â”‚  LAYER_START   â”‚  â† New layer begins                â”‚
    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                    â”‚
    â”‚           â†“                                              â”‚
    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                    â”‚
    â”‚   â”‚  TRACK_START   â”‚  â† New track begins                â”‚
    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                    â”‚
    â”‚           â†“                                              â”‚
    â”‚   â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—             â”‚
    â”‚   â•‘       STEP LOOP (repeats)             â•‘             â”‚
    â”‚   â•‘                                       â•‘             â”‚
    â”‚   â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â•‘             â”‚
    â”‚   â•‘  â”‚  STEP_START  â”‚  Before physics    â•‘             â”‚
    â”‚   â•‘  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                    â•‘             â”‚
    â”‚   â•‘         â†“                             â•‘             â”‚
    â”‚   â•‘  [ Physics Calculation ]              â•‘             â”‚
    â”‚   â•‘         â†“                             â•‘             â”‚
    â”‚   â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â•‘             â”‚
    â”‚   â•‘  â”‚STEP_COMPLETE â”‚  After physics     â•‘             â”‚
    â”‚   â•‘  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                    â•‘             â”‚
    â”‚   â•‘         â†“                             â•‘             â”‚
    â”‚   â•‘  Continue? â”€â”€Yesâ†’ Loop back          â•‘             â”‚
    â”‚   â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•             â”‚
    â”‚           â†“ No (track done)                             â”‚
    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                    â”‚
    â”‚   â”‚ TRACK_COMPLETE â”‚                                    â”‚
    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                    â”‚
    â”‚           â†“                                              â”‚
    â”‚   More tracks? â”€â”€Yesâ†’ Back to TRACK_START               â”‚
    â”‚           â†“ No (layer done)                             â”‚
    â”‚   More layers? â”€â”€Yesâ†’ Back to LAYER_START               â”‚
    â”‚                                                          â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â†“ No (all layers done)
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚    COMPLETE      â”‚  â† Simulation finished
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    (any time) â”€â”€â”€â”€â†’â”‚      ERROR       â”‚  â† If error occurs
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2ï¸âƒ£ CALLBACK CATEGORIES & USE CASES (19 Total)

### ğŸ“ CATEGORY A: COMPLETION CALLBACKS (4)
**Purpose:** Stop simulation when condition is met (raises `SimulationComplete` exception)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  COMPLETION CALLBACKS - When to stop simulation                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  1. HeightCompletionCallback                                   â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚     â”‚ Event: LAYER_START                  â”‚                    â”‚
â”‚     â”‚ Stops when: Height â‰¥ target_height  â”‚                    â”‚
â”‚     â”‚ Use: Production builds              â”‚                    â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚     Example: HeightCompletionCallback(target_height=0.005)     â”‚
â”‚              â†’ Stop when part reaches 5mm                      â”‚
â”‚                                                                 â”‚
â”‚  2. StepCountCompletionCallback                                â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚     â”‚ Event: STEP_COMPLETE                â”‚                    â”‚
â”‚     â”‚ Stops when: Steps â‰¥ max_steps       â”‚                    â”‚
â”‚     â”‚ Use: Debugging, RL episodes         â”‚                    â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚     Example: StepCountCompletionCallback(max_steps=50)         â”‚
â”‚              â†’ Stop after exactly 50 steps                     â”‚
â”‚                                                                 â”‚
â”‚  3. TrackCountCompletionCallback                               â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚     â”‚ Event: TRACK_COMPLETE               â”‚                    â”‚
â”‚     â”‚ Stops when: Tracks â‰¥ max_tracks     â”‚                    â”‚
â”‚     â”‚ Use: Partial builds                 â”‚                    â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚     Example: TrackCountCompletionCallback(max_tracks=10)       â”‚
â”‚              â†’ Stop after 10 tracks                            â”‚
â”‚                                                                 â”‚
â”‚  4. LayerCountCompletionCallback                               â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚     â”‚ Event: LAYER_START                  â”‚                    â”‚
â”‚     â”‚ Stops when: Layers â‰¥ max_layers     â”‚                    â”‚
â”‚     â”‚ Use: Controlled builds              â”‚                    â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚     Example: LayerCountCompletionCallback(max_layers=5)        â”‚
â”‚              â†’ Stop after 5 layers                             â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### ğŸ“Š CATEGORY B: DATA COLLECTION (2)
**Purpose:** Collect simulation data for analysis, ML, or optimization

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  DATA COLLECTION - Recording simulation state                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  5. StepDataCollector â­ (AUTO-ADDED BY DEFAULT)               â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚     â”‚ Events: STEP_COMPLETE, COMPLETE                â”‚         â”‚
â”‚     â”‚ Collects: User-defined fields per step        â”‚         â”‚
â”‚     â”‚ Saves: CSV file at completion                  â”‚         â”‚
â”‚     â”‚ Use: RL training, process optimization         â”‚         â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                 â”‚
â”‚     Available fields to track:                                 â”‚
â”‚       â€¢ position     - (x, y, z) coordinates                   â”‚
â”‚       â€¢ voxel        - Discretized indices                     â”‚
â”‚       â€¢ build        - Layer, track, direction info            â”‚
â”‚       â€¢ melt_pool    - Width, length, depth                    â”‚
â”‚       â€¢ clad         - Width, height, wetting angle            â”‚
â”‚       â€¢ profile      - Track geometry parameters               â”‚
â”‚       â€¢ temperature  - Max temp + depth profile                â”‚
â”‚                                                                 â”‚
â”‚     Example 1: Track everything                                â”‚
â”‚       StepDataCollector(                                       â”‚
â”‚           tracked_fields=None,  # None = track all             â”‚
â”‚           save_path="data.csv"                                 â”‚
â”‚       )                                                         â”‚
â”‚                                                                 â”‚
â”‚     Example 2: RL observation space                            â”‚
â”‚       collector = StepDataCollector(                           â”‚
â”‚           tracked_fields=['position', 'melt_pool', 'clad'],    â”‚
â”‚           save_path=None  # Don't save, access via .step_data  â”‚
â”‚       )                                                         â”‚
â”‚       # Access during simulation:                              â”‚
â”‚       obs = collector.current_step_dict                        â”‚
â”‚       # â†’ {'step': 42, 'position.x': 0.003, ...}               â”‚
â”‚                                                                 â”‚
â”‚  6. ParameterLogger                                            â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚     â”‚ Events: STEP_COMPLETE, COMPLETE                â”‚         â”‚
â”‚     â”‚ Collects: Process parameter values per step   â”‚         â”‚
â”‚     â”‚ Saves: CSV with parameter history              â”‚         â”‚
â”‚     â”‚ Use: Adaptive control analysis                 â”‚         â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                 â”‚
â”‚     Example:                                                    â”‚
â”‚       ParameterLogger(save_file="params.csv")                  â”‚
â”‚       â†’ Saves: step, param.laser_power, param.scan_speed, ...  â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### ğŸ“ˆ CATEGORY C: VISUALIZATION (4)
**Purpose:** Real-time and saved visualization of simulation state

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  VISUALIZATION - Display and plot simulation data              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  7. AdvancedLivePlotter                                        â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚     â”‚ Event: STEP_COMPLETE (with interval)          â”‚         â”‚
â”‚     â”‚ Shows: Live 3D thermal visualization          â”‚         â”‚
â”‚     â”‚ Display: 4 subplots (XY, XZ, YZ, Cross-sec)   â”‚         â”‚
â”‚     â”‚ Use: Monitoring complex simulations           â”‚         â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                 â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚               â”‚
â”‚     â”‚  â”‚ XY Viewâ”‚ XZ Viewâ”‚ YZ Viewâ”‚            â”‚               â”‚
â”‚     â”‚  â”‚ (Top)  â”‚ (Front)â”‚ (Side) â”‚            â”‚               â”‚
â”‚     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚               â”‚
â”‚     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚               â”‚
â”‚     â”‚  â”‚   Cross-Section (Layers)   â”‚          â”‚               â”‚
â”‚     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚               â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                                                 â”‚
â”‚     Example:                                                    â”‚
â”‚       AdvancedLivePlotter(                                     â”‚
â”‚           interval=5,           # Update every 5 steps         â”‚
â”‚           temp_range=(300, 2500)                               â”‚
â”‚       )                                                         â”‚
â”‚                                                                 â”‚
â”‚  8. LivePlotter                                                â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚     â”‚ Event: STEP_COMPLETE (with interval)          â”‚         â”‚
â”‚     â”‚ Shows: Simple height vs step plot             â”‚         â”‚
â”‚     â”‚ Use: Quick progress monitoring                â”‚         â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                 â”‚
â”‚     Height (mm)                                                â”‚
â”‚       â”‚     â•±â”€â”€â”€                                               â”‚
â”‚       â”‚   â•±â”€                                                   â”‚
â”‚       â”‚ â•±                                                      â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> Steps                                       â”‚
â”‚                                                                 â”‚
â”‚  9. ThermalPlotSaver                                           â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚     â”‚ Event: STEP_COMPLETE (with interval)          â”‚         â”‚
â”‚     â”‚ Saves: PNG images of thermal views            â”‚         â”‚
â”‚     â”‚ Files: thermal####_top/front/side_view.png    â”‚         â”‚
â”‚     â”‚ Use: Creating animations, documentation       â”‚         â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                 â”‚
â”‚     Example:                                                    â”‚
â”‚       ThermalPlotSaver(interval=10)                            â”‚
â”‚       â†’ thermal_plots/thermal0010_top_view.png                 â”‚
â”‚       â†’ thermal_plots/thermal0010_front_view.png               â”‚
â”‚       â†’ thermal_plots/thermal0010_side_view.png                â”‚
â”‚                                                                 â”‚
â”‚  10. CrossSectionPlotter                                       â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚     â”‚ Event: COMPLETE                                â”‚         â”‚
â”‚     â”‚ Saves: Cross-section plots at end             â”‚         â”‚
â”‚     â”‚ Files: cross_section_y###mm.png                â”‚         â”‚
â”‚     â”‚ Use: Analyzing final geometry                 â”‚         â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                 â”‚
â”‚     Z (mm)   Layer 3 â”€â”€â”€                                       â”‚
â”‚       â”‚      Layer 2 â”€â”€                                        â”‚
â”‚       â”‚      Layer 1 â”€                                         â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> X (mm)                              â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### ğŸ’¾ CATEGORY D: SAVING/EXPORT (5)
**Purpose:** Save simulation state to disk for later analysis

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SAVING/EXPORT - Persist simulation data to files              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  11. TemperatureSliceSaver                                     â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚     â”‚ Event: STEP_COMPLETE (with interval)          â”‚         â”‚
â”‚     â”‚ Saves: 2D temperature slices (XY, XZ, YZ)     â”‚         â”‚
â”‚     â”‚ Format: .npy files (numpy arrays)             â”‚         â”‚
â”‚     â”‚ Use: Detailed thermal analysis                â”‚         â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                 â”‚
â”‚     Files saved per step:                                      â”‚
â”‚       temperatures/xy_slice_step0042.npy  â† (nx, ny) array     â”‚
â”‚       temperatures/xz_slice_step0042.npy  â† (nx, nz) array     â”‚
â”‚       temperatures/yz_slice_step0042.npy  â† (ny, nz) array     â”‚
â”‚                                                                 â”‚
â”‚  12. VoxelTemperatureSaver                                     â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚     â”‚ Event: STEP_COMPLETE (with interval)          â”‚         â”‚
â”‚     â”‚ Saves: Full 3D temperature field              â”‚         â”‚
â”‚     â”‚ Format: .npy (large files!)                   â”‚         â”‚
â”‚     â”‚ Use: Complete thermal reconstruction          â”‚         â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                 â”‚
â”‚     Files saved:                                                â”‚
â”‚       voxel_temps/voxel_temps_step0042.npy  â† (nx, ny, nz)     â”‚
â”‚                                                                 â”‚
â”‚     âš ï¸  WARNING: Large files! Use interval=10 or higher        â”‚
â”‚                                                                 â”‚
â”‚  13. MeshSaver                                                 â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚     â”‚ Event: STEP_COMPLETE (with interval)          â”‚         â”‚
â”‚     â”‚ Saves: 3D mesh of built geometry              â”‚         â”‚
â”‚     â”‚ Format: .stl (Standard Tessellation Language) â”‚         â”‚
â”‚     â”‚ Use: 3D visualization (MeshLab, ParaView)     â”‚         â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                 â”‚
â”‚     Files saved:                                                â”‚
â”‚       build_mesh/build_state_step0042.stl                      â”‚
â”‚                                                                 â”‚
â”‚     Can view in: Blender, MeshLab, ParaView, FreeCAD           â”‚
â”‚                                                                 â”‚
â”‚  14. FinalStateSaver                                           â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚     â”‚ Event: COMPLETE                                â”‚         â”‚
â”‚     â”‚ Saves: Final state snapshots                  â”‚         â”‚
â”‚     â”‚ Files: activated vol, temp field, summary     â”‚         â”‚
â”‚     â”‚ Use: Post-processing, analysis                â”‚         â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                 â”‚
â”‚     Files saved:                                                â”‚
â”‚       final_activated_vol.npy     â† Which voxels activated     â”‚
â”‚       final_temperature_vol.npy   â† Final temperature field    â”‚
â”‚       simulation_params.csv       â† Summary statistics         â”‚
â”‚                                                                 â”‚
â”‚  15. PickleSaver                                               â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚     â”‚ Event: COMPLETE (or custom)                   â”‚         â”‚
â”‚     â”‚ Saves: Any Python object as pickle            â”‚         â”‚
â”‚     â”‚ Use: Save custom state/managers               â”‚         â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                 â”‚
â”‚     Example:                                                    â”‚
â”‚       PickleSaver(                                             â”‚
â”‚           obj_getter=lambda ctx: ctx['simulation'].clad_manager,â”‚
â”‚           save_file="clad_manager.pkl"                         â”‚
â”‚       )                                                         â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### âš™ï¸ CATEGORY E: CONTROL & CALIBRATION (2)
**Purpose:** Modify simulation behavior dynamically

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CONTROL & CALIBRATION - Adaptive behavior                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  16. TrackCalibrationCallback                                  â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚     â”‚ Event: CONFIG_LOADED                           â”‚         â”‚
â”‚     â”‚ Action: Run calibration track                 â”‚         â”‚
â”‚     â”‚ Modifies: Hatch & layer spacing               â”‚         â”‚
â”‚     â”‚ Use: Auto-calibrate process parameters        â”‚         â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                 â”‚
â”‚     How it works:                                               â”‚
â”‚       1. Run calibration track (10 steps)                      â”‚
â”‚       2. Measure actual clad width & height                    â”‚
â”‚       3. Calculate optimal spacing:                            â”‚
â”‚          â€¢ hatch_spacing = width Ã— (1 - overlap%)              â”‚
â”‚          â€¢ layer_spacing = height Ã— (1 - overlap%)             â”‚
â”‚       4. Update simulation config                              â”‚
â”‚                                                                 â”‚
â”‚     Example:                                                    â”‚
â”‚       TrackCalibrationCallback(                                â”‚
â”‚           calibration_steps=10,                                â”‚
â”‚           hatch_overlap_percent=30,  # 30% track overlap       â”‚
â”‚           layer_overlap_percent=50   # 50% layer overlap       â”‚
â”‚       )                                                         â”‚
â”‚                                                                 â”‚
â”‚     Output:                                                     â”‚
â”‚       ============================================                â”‚
â”‚       TRACK CALIBRATION                                        â”‚
â”‚       ============================================                â”‚
â”‚       Measured: 0.450mm wide, 0.280mm high                     â”‚
â”‚       Original: 0.500mm hatch, 0.350mm layer                   â”‚
â”‚       Recommended: 0.315mm hatch, 0.140mm layer                â”‚
â”‚       ============================================                â”‚
â”‚                                                                 â”‚
â”‚  17. Custom Callbacks (User-defined)                           â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚     â”‚ Events: Any                                    â”‚         â”‚
â”‚     â”‚ Use: RL actions, adaptive control, custom     â”‚         â”‚
â”‚     â”‚      logic, reward calculation                â”‚         â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                 â”‚
â”‚     Example: RL Reward Callback                                â”‚
â”‚       class RewardCallback(BaseCallback):                      â”‚
â”‚           def __init__(self):                                  â”‚
â”‚               super().__init__(                                â”‚
â”‚                   events=SimulationEvent.STEP_COMPLETE         â”‚
â”‚               )                                                 â”‚
â”‚               self.total_reward = 0.0                          â”‚
â”‚                                                                 â”‚
â”‚           def _execute(self, context):                         â”‚
â”‚               sim = context['simulation']                      â”‚
â”‚               step_ctx = sim.step_context                      â”‚
â”‚                                                                 â”‚
â”‚               # Calculate reward                               â”‚
â”‚               temp = step_ctx['melt_pool']['max_temp']         â”‚
â”‚               temp_reward = -abs(temp - 1600) / 100            â”‚
â”‚                                                                 â”‚
â”‚               self.total_reward += temp_reward                 â”‚
â”‚               return temp_reward                               â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### ğŸ”” CATEGORY F: MONITORING & ERROR HANDLING (2)
**Purpose:** Progress tracking and error management

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  MONITORING & ERROR HANDLING                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  18. ProgressPrinter                                           â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚     â”‚ Events: INIT, TRACK_COMPLETE                   â”‚         â”‚
â”‚     â”‚ Action: Print to console                       â”‚         â”‚
â”‚     â”‚ Use: Monitor progress in real-time            â”‚         â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                 â”‚
â”‚     Console output:                                             â”‚
â”‚       Simulation initialized with parameters:                  â”‚
â”‚       Build volume: [0.1, 0.1, 0.05] mm/voxel                  â”‚
â”‚       Volume shape: (100, 100, 50) voxels                      â”‚
â”‚       Track length: 10.0 mm                                    â”‚
â”‚       Hatch spacing: 0.5 mm                                    â”‚
â”‚       ...                                                       â”‚
â”‚                                                                 â”‚
â”‚       Layer (count):   1  |  Track (count):   1  |  Height: 0.28mmâ”‚
â”‚       Layer (count):   1  |  Track (count):   2  |  Height: 0.28mmâ”‚
â”‚       Layer (count):   1  |  Track (count):   3  |  Height: 0.28mmâ”‚
â”‚       ...                                                       â”‚
â”‚                                                                 â”‚
â”‚  19. ErrorCompletionCallback â­ (AUTO-ADDED BY DEFAULT)        â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚     â”‚ Event: ERROR                                   â”‚         â”‚
â”‚     â”‚ Action: Call sim.complete() for cleanup       â”‚         â”‚
â”‚     â”‚ Use: Ensure callbacks run even on error       â”‚         â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                 â”‚
â”‚     Flow on error:                                              â”‚
â”‚       1. Error occurs during simulation                        â”‚
â”‚       2. Simulation triggers ERROR event                       â”‚
â”‚       3. ErrorCompletionCallback catches it                    â”‚
â”‚       4. Calls sim.complete()                                  â”‚
â”‚       5. COMPLETE event fires â†’ cleanup callbacks run          â”‚
â”‚       6. Data saved even though simulation failed              â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### ğŸ—œï¸ CATEGORY G: UTILITIES (1)
**Purpose:** Post-processing and cleanup

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  UTILITIES - Post-processing                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  20. CompressCallback                                          â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚     â”‚ Event: COMPLETE                                â”‚         â”‚
â”‚     â”‚ Action: Compress directories to archives      â”‚         â”‚
â”‚     â”‚ Use: Save disk space                          â”‚         â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                 â”‚
â”‚     Example:                                                    â”‚
â”‚       CompressCallback(                                        â”‚
â”‚           target_dir="temperatures",                           â”‚
â”‚           archive_format='zip',      # or 'tar', 'gztar'       â”‚
â”‚           remove_original=True       # Delete after compress   â”‚
â”‚       )                                                         â”‚
â”‚                                                                 â”‚
â”‚     Before:                           After:                   â”‚
â”‚       temperatures/                   temperatures.zip         â”‚
â”‚         xy_slice_0001.npy                                      â”‚
â”‚         xy_slice_0002.npy                                      â”‚
â”‚         ...                                                     â”‚
â”‚       (200 files, 500MB)              (1 file, 150MB)          â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3ï¸âƒ£ CALLBACK MANAGER AUTO-CONFIGURATION

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CallbackManager - Auto-adds missing defaults                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

When you create: CallbackManager([callback1, callback2, ...])

It automatically checks and adds:

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  1. ErrorCompletionCallback                          â”‚
  â”‚     Added if: No error callback present              â”‚
  â”‚     Why: Ensure cleanup on error                     â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â†“
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  2. StepDataCollector                                â”‚
  â”‚     Added if: No data collector present              â”‚
  â”‚     Config: tracked_fields=None, save_path=None      â”‚
  â”‚     Why: Always have data accessible                 â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â†“
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  3. Completion Warning                               â”‚
  â”‚     Warns if: No completion callback present         â”‚
  â”‚     Why: Prevent infinite simulation                 â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Example:

  # You provide:
  callbacks = [ProgressPrinter()]
  manager = CallbackManager(callbacks)

  # Manager actually has:
  manager.callbacks = [
      ProgressPrinter(),              # Your callback
      ErrorCompletionCallback(),      # Auto-added
      StepDataCollector()             # Auto-added
  ]

  # Plus warning:
  RuntimeWarning: No completion callback detected -
                  simulation will run indefinitely!
```

---

## 4ï¸âƒ£ COMMON USE CASE PATTERNS

### ğŸ¯ Pattern 1: Reinforcement Learning Environment

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  RL TRAINING PATTERN                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Goal: Train RL agent to optimize process parameters

callbacks = [
    # Episode termination
    StepCountCompletionCallback(max_steps=100),

    # Custom reward calculation
    CustomRewardCallback(),

    # State observation
    StepDataCollector(
        tracked_fields=['position', 'melt_pool', 'clad', 'temperature'],
        save_path=None  # Don't save, access in-memory
    )
]

# Training loop:
for episode in range(1000):
    sim = Simulation(callbacks=callbacks)
    manager = CallbackManager(callbacks)

    try:
        while True:
            # Get action from agent
            action = agent.get_action(state)

            # Step simulation
            sim.step(params=action)
            manager(sim, SimulationEvent.STEP_COMPLETE)

            # Get new state
            data_collector = find_callback(manager, StepDataCollector)
            state = data_collector.current_step_dict

            # Get reward
            reward_callback = find_callback(manager, CustomRewardCallback)
            reward = reward_callback.total_reward

            # Train agent
            agent.update(state, action, reward, next_state)

    except SimulationComplete:
        # Episode done
        pass

Flow diagram:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  RL Agent   â”‚
  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
         â”‚ action (laser_power, scan_speed, ...)
         â†“
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚   Simulation     â”‚
  â”‚   (1 step)       â”‚
  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ triggers STEP_COMPLETE
         â†“
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  Callbacks execute:                  â”‚
  â”‚  â€¢ StepDataCollector â†’ new state     â”‚
  â”‚  â€¢ CustomReward â†’ reward             â”‚
  â”‚  â€¢ StepCount â†’ check if done         â”‚
  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ (state, reward, done)
         â†“
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  RL Agent   â”‚
  â”‚  (learns)   â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### ğŸ­ Pattern 2: Full Production Simulation

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PRODUCTION SIMULATION PATTERN                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Goal: Run complete build with full data saving

from callbacks.callback_collection import get_default_callbacks

callbacks = get_default_callbacks()

# Or customize:
callbacks = [
    # Auto-calibrate first
    TrackCalibrationCallback(
        hatch_overlap_percent=30,
        layer_overlap_percent=50
    ),

    # Stop at target height
    HeightCompletionCallback(),

    # Live monitoring
    AdvancedLivePlotter(interval=5),
    ProgressPrinter(),

    # Data collection
    StepDataCollector(tracked_fields=None, save_path="data.csv"),
    ParameterLogger(),

    # Save thermal data (sparse to save space)
    TemperatureSliceSaver(interval=10),
    VoxelTemperatureSaver(interval=50),
    ThermalPlotSaver(interval=10),

    # Save geometry
    MeshSaver(interval=20),

    # Final outputs
    CrossSectionPlotter(num_sections=10),
    FinalStateSaver(),

    # Compress large directories
    CompressCallback(target_dir="temperatures"),
    CompressCallback(target_dir="voxel_temps"),
]

Output structure:
  simulation_output/
    â”œâ”€â”€ data.csv                      â† StepDataCollector
    â”œâ”€â”€ parameter_history.csv         â† ParameterLogger
    â”œâ”€â”€ final_activated_vol.npy       â† FinalStateSaver
    â”œâ”€â”€ final_temperature_vol.npy     â† FinalStateSaver
    â”œâ”€â”€ simulation_params.csv         â† FinalStateSaver
    â”œâ”€â”€ temperatures.zip              â† CompressCallback
    â”œâ”€â”€ voxel_temps.zip               â† CompressCallback
    â”œâ”€â”€ thermal_plots/
    â”‚   â”œâ”€â”€ thermal0010_top_view.png
    â”‚   â”œâ”€â”€ thermal0010_front_view.png
    â”‚   â”œâ”€â”€ ...
    â”œâ”€â”€ build_mesh/
    â”‚   â”œâ”€â”€ build_state_step0020.stl
    â”‚   â”œâ”€â”€ build_state_step0040.stl
    â”‚   â”œâ”€â”€ ...
    â””â”€â”€ cross_sections/
        â”œâ”€â”€ cross_section_y0.5mm.png
        â”œâ”€â”€ cross_section_y1.0mm.png
        â””â”€â”€ ...
```

---

### ğŸ› Pattern 3: Quick Debugging

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  DEBUGGING PATTERN                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Goal: Test changes quickly without full simulation

callbacks = [
    # Run for just 10 steps
    StepCountCompletionCallback(max_steps=10),

    # See what's happening
    ProgressPrinter(),

    # Optional: Check specific data
    StepDataCollector(
        tracked_fields=['melt_pool', 'temperature'],
        save_path=None
    ),
]

# Add breakpoint to inspect
import pdb; pdb.set_trace()

# Or print intermediate values
class DebugCallback(BaseCallback):
    def __init__(self):
        super().__init__(events=SimulationEvent.STEP_COMPLETE)

    def _execute(self, context):
        sim = context['simulation']
        print(f"Step {sim.progress_tracker.step_count}")
        print(f"  Position: {sim.step_context['position']}")
        print(f"  Max temp: {sim.step_context['melt_pool']['max_temp']}")

callbacks.append(DebugCallback())
```

---

### ğŸ“¹ Pattern 4: Create Animation

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ANIMATION CREATION PATTERN                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Goal: Generate frames for video

callbacks = [
    HeightCompletionCallback(),

    # Save every step for smooth animation
    ThermalPlotSaver(interval=1, save_dir="animation_frames"),

    ProgressPrinter(),
]

# After simulation, create video:
# ffmpeg -framerate 30 -pattern_type glob -i 'animation_frames/*.png' \
#        -c:v libx264 -pix_fmt yuv420p simulation.mp4

Frame sequence:
  animation_frames/
    â”œâ”€â”€ thermal0001_top_view.png
    â”œâ”€â”€ thermal0002_top_view.png
    â”œâ”€â”€ thermal0003_top_view.png
    â”œâ”€â”€ ...
    â””â”€â”€ thermal1000_top_view.png
            â†“
    (ffmpeg command)
            â†“
    simulation.mp4 (30 fps video)
```

---

## 5ï¸âƒ£ CREATING CUSTOM CALLBACKS

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CUSTOM CALLBACK TEMPLATE                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

from callbacks._base_callbacks import BaseCallback, SimulationEvent

class MyCustomCallback(BaseCallback):
    """
    Brief description of what this callback does.
    """

    def __init__(self, my_param=10, **kwargs):
        """
        Initialize callback.

        Args:
            my_param: Description
            **kwargs: Passed to BaseCallback
        """
        # Choose which events to listen to
        super().__init__(
            events=SimulationEvent.STEP_COMPLETE,  # or list of events
            **kwargs
        )

        self.my_param = my_param
        self.data = []  # Store any state you need

    def _execute(self, context: dict) -> None:
        """
        Called when event fires.

        Args:
            context: Dict with:
                - 'event': SimulationEvent
                - 'simulation': Full simulation object
                - ... other event-specific data
        """
        sim = context['simulation']

        # Access simulation state
        step_num = sim.progress_tracker.step_count
        step_ctx = sim.step_context

        # Do your logic
        if step_num % self.my_param == 0:
            temp = step_ctx['melt_pool']['max_temp']
            self.data.append(temp)
            print(f"Step {step_num}: Temp = {temp}K")

        # Optionally save files
        if context['event'] == SimulationEvent.COMPLETE:
            save_path = self.resolve_path(context, "my_data.txt")
            with open(save_path, 'w') as f:
                f.write(str(self.data))

Usage:
  callbacks = [
      MyCustomCallback(my_param=5),
      StepCountCompletionCallback(max_steps=100)
  ]
```

---

## 6ï¸âƒ£ DEBUGGING CALLBACKS

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  DEBUGGING TECHNIQUES                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Problem 1: Can't find StepDataCollector
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  âŒ WRONG (isinstance fails due to import paths):
    for cb in manager.callbacks:
        if isinstance(cb, StepDataCollector):
            data_collector = cb

  âœ… RIGHT (duck typing):
    for cb in manager.callbacks:
        if hasattr(cb, 'step_data') and hasattr(cb, 'current_step_dict'):
            data_collector = cb

Problem 2: Want to see all active callbacks
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  for i, cb in enumerate(manager.callbacks):
      print(f"{i}. {cb.__class__.__name__}")
      print(f"   Events: {[e.name for e in cb.events]}")
      print(f"   Enabled: {cb.enabled}")

Problem 3: Callback not executing
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # Check if callback is enabled
  cb.enabled  # Should be True

  # Check if event is registered
  SimulationEvent.STEP_COMPLETE in cb.events  # Should be True

  # Check event count
  cb._event_counts  # How many times each event fired

Problem 4: Need to inspect state during execution
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  class DebugCallback(BaseCallback):
      def __init__(self):
          super().__init__(events=SimulationEvent.STEP_COMPLETE)

      def _execute(self, context):
          import pdb; pdb.set_trace()  # â† Debugger breaks here
          # Now inspect: context, sim, step_context, etc.

Problem 5: Understanding the "[Callback Error]" messages
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  These messages show up when SimulationComplete is raised:

  [Callback Error] StepCountCompletionCallback failed during STEP_COMPLETE
  Original error: Build stopped: completed 50 steps (limit: 50)

  This is NOT an error! It's intentional completion.

  Why it looks like error:
    â€¢ SimulationComplete inherits from Exception
    â€¢ CallbackManager catches it and re-raises with prefix
    â€¢ This is normal control flow
```

---

## 7ï¸âƒ£ SUMMARY TABLE

```
â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ID   â”‚ Callback Name                â”‚ Events          â”‚ Category    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  1   â”‚ HeightCompletionCallback     â”‚ LAYER_START     â”‚ Completion  â”‚
â”‚  2   â”‚ StepCountCompletionCallback  â”‚ STEP_COMPLETE   â”‚ Completion  â”‚
â”‚  3   â”‚ TrackCountCompletionCallback â”‚ TRACK_COMPLETE  â”‚ Completion  â”‚
â”‚  4   â”‚ LayerCountCompletionCallback â”‚ LAYER_START     â”‚ Completion  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  5   â”‚ StepDataCollector â­         â”‚ STEP_COMPLETE   â”‚ Data        â”‚
â”‚      â”‚                              â”‚ COMPLETE        â”‚             â”‚
â”‚  6   â”‚ ParameterLogger              â”‚ STEP_COMPLETE   â”‚ Data        â”‚
â”‚      â”‚                              â”‚ COMPLETE        â”‚             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  7   â”‚ AdvancedLivePlotter          â”‚ STEP_COMPLETE   â”‚ Visual      â”‚
â”‚  8   â”‚ LivePlotter                  â”‚ STEP_COMPLETE   â”‚ Visual      â”‚
â”‚  9   â”‚ ThermalPlotSaver             â”‚ STEP_COMPLETE   â”‚ Visual      â”‚
â”‚ 10   â”‚ CrossSectionPlotter          â”‚ COMPLETE        â”‚ Visual      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 11   â”‚ TemperatureSliceSaver        â”‚ STEP_COMPLETE   â”‚ Saving      â”‚
â”‚ 12   â”‚ VoxelTemperatureSaver        â”‚ STEP_COMPLETE   â”‚ Saving      â”‚
â”‚ 13   â”‚ MeshSaver                    â”‚ STEP_COMPLETE   â”‚ Saving      â”‚
â”‚ 14   â”‚ FinalStateSaver              â”‚ COMPLETE        â”‚ Saving      â”‚
â”‚ 15   â”‚ PickleSaver                  â”‚ COMPLETE        â”‚ Saving      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 16   â”‚ TrackCalibrationCallback     â”‚ CONFIG_LOADED   â”‚ Control     â”‚
â”‚ 17   â”‚ Custom (user-defined)        â”‚ Any             â”‚ Control     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 18   â”‚ ProgressPrinter              â”‚ INIT            â”‚ Monitor     â”‚
â”‚      â”‚                              â”‚ TRACK_COMPLETE  â”‚             â”‚
â”‚ 19   â”‚ ErrorCompletionCallback â­   â”‚ ERROR           â”‚ Monitor     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 20   â”‚ CompressCallback             â”‚ COMPLETE        â”‚ Utility     â”‚
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â­ = Auto-added by CallbackManager if not present

Total: 19 callback types (+ custom user callbacks)
```

---

## 8ï¸âƒ£ QUICK REFERENCE

```
Event Timing:
  CONFIG_LOADED â†’ Once at start (before INIT)
  INIT          â†’ Once at start
  LAYER_START   â†’ Each layer
  TRACK_START   â†’ Each track
  STEP_START    â†’ Each step (before physics)
  STEP_COMPLETE â†’ Each step (after physics) â† MOST COMMON
  TRACK_COMPLETEâ†’ Each track end
  COMPLETE      â†’ Once at end
  ERROR         â†’ On error

Most Used Callbacks:
  â€¢ StepDataCollector      - Get simulation data
  â€¢ StepCountCompletionCallback - Limit steps
  â€¢ HeightCompletionCallback    - Stop at height
  â€¢ ProgressPrinter        - See progress
  â€¢ AdvancedLivePlotter    - Visualize live
  â€¢ ThermalPlotSaver       - Save plots

Helper Functions (callback_collection.py):
  get_default_callbacks()       - Full production setup
  get_visualization_callbacks() - All visualization
  get_data_callbacks()          - All data saving
  get_monitoring_callbacks()    - Progress tracking
  get_compression_callbacks()   - Compress outputs
```

---

**END OF GUIDE**